name: bluez
version: 5.37-1
icon: icon.png
type: app
summary: Bluetooth tools and daemons
description: "This package contains tools and system daemons for using Bluetooth
devices. BlueZ is the official Linux Bluetooth protocol stack. It is an Open Source
project distributed under GNU General Public License (GPL)."

apps:
  bluetoothctl:
    command: usr/bin/bluetoothctl
    caps:
      - bluez_client
  bluez:
    command: "usr/lib/bluetooth/bluetoothd -E"
    daemon: simple
    security-policy:
      apparmor: bluez.apparmor
      seccomp: bluez.seccomp
  obex:
    command: "usr/lib/bluetooth/obexd"
    daemon: simple
    security-policy:
      apparmor: obex.apparmor
      seccomp: obex.seccomp

parts:
  bluez:
    plugin: autotools
    source: git://git.kernel.org/pub/scm/bluetooth/bluez.git
    source-tag: "5.37"
    configflags:
      - --prefix=/usr
      - --libexec=/usr/lib/
      - --enable-experimental
      - --enable-snappy
      - --enable-threads
      - --disable-cups
      - --disable-monitor
      - --enable-obex
      - --disable-systemd
      - --disable-silent-rules
    build-packages:
      - libreadline6-dev    
      - libudev-dev
      - pkg-config
    stage-packages:
      - libglib2.0-dev
      - libdbus-1-dev
      - libical1a 
    filesets:
      libical1a:
        - usr/lib/*/libical*
    snap:
      - usr/lib/bluetooth/bluetoothd
      - usr/lib/bluetooth/obexd
      - usr/bin/bluetoothctl
      - usr/share/doc/libical1a/copyright
      - $libical1a
  dbus-configuration:
    plugin: copy
    files: 
      conf/bluez-dbus.conf: conf/bluez-dbus.conf
      meta/framework-policy: meta/framework-policy
      copyright: usr/share/doc/bluez/copyright
